<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Dashboard - Cidade Inteligente</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../static/style_bootstrap.css?v=1">
</head>
<body class="bg-dark text-light">
    <!-- FIXED FILE -->
    <!-- Header -->
    <nav class="navbar navbar-dark bg-darker border-bottom border-info">
        <div class="container-fluid">
            <span class="navbar-brand mb-0 h1">üèôÔ∏è Cidade Inteligente - Dashboard</span>
            <button onclick="logout()" class="btn btn-danger btn-sm">Sair</button>
        </div>
    </nav>
    
    <div class="container-fluid mt-4">
        <div class="row">
            <!-- Sidebar -->
            <div class="col-lg-3 col-xl-2 mb-4">
                <div class="card bg-darker border-info">
                    <div class="card-body">
                        <h5 class="card-title text-info">Regi√µes</h5>
                        <div id="regioes-list" class="list-group list-group-flush mb-3">
                            <p class="text-muted">Carregando regi√µes...</p>
                        </div>
                        <button onclick="showAddRegiao()" class="btn btn-info btn-sm w-100">‚ûï Nova Regi√£o</button>
                    </div>
                </div>
            </div>
            
            <!-- Main Content -->
            <div class="col-lg-9 col-xl-10">
                <!-- Tabs -->
                <ul class="nav nav-tabs mb-4 border-bottom border-info" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active text-info" onclick="switchTab('dashboard')" id="dashboard-tab-btn">üìä Dashboard</button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link text-info" onclick="switchTab('semaforos')" id="semaforos-tab-btn">üö¶ Sem√°foros</button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link text-info" onclick="switchTab('postes')" id="postes-tab-btn">üí° Postes</button>
                    </li>
                </ul>
                
                <!-- Dashboard Tab -->
                <div id="dashboard-tab" class="tab-content active">
                    <div id="region-selected" class="alert alert-info" role="alert">
                        <p class="mb-0">Selecione uma regi√£o para ver o dashboard</p>
                    </div>
                    <div id="dashboard-content" style="display: none;">
                        <!-- Stats Grid -->
                        <div class="row g-3 mb-4">
                            <div class="col-md-6 col-lg-3">
                                <div class="card bg-darker border-info h-100">
                                    <div class="card-body">
                                        <h6 class="card-title text-info">üìä Total Sem√°foros</h6>
                                        <p id="total-semaforos" class="fs-4 fw-bold text-success mb-0">0</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6 col-lg-3">
                                <div class="card bg-darker border-info h-100">
                                    <div class="card-body">
                                        <h6 class="card-title text-info">üí° Total Postes</h6>
                                        <p id="total-postes" class="fs-4 fw-bold text-success mb-0">0</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6 col-lg-3">
                                <div class="card bg-darker border-info h-100">
                                    <div class="card-body">
                                        <h6 class="card-title text-info">üìà Efic. Sem√°foros</h6>
                                        <p id="eficiencia-semaforos" class="fs-4 fw-bold text-warning mb-0">0%</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6 col-lg-3">
                                <div class="card bg-darker border-info h-100">
                                    <div class="card-body">
                                        <h6 class="card-title text-info">üìà Efic. Postes</h6>
                                        <p id="eficiencia-postes" class="fs-4 fw-bold text-warning mb-0">0%</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Top Lists -->
                        <div class="row g-3">
                            <div class="col-lg-6">
                                <div class="card bg-darker border-success">
                                    <div class="card-header bg-dark border-success">
                                        <h6 class="mb-0 text-success">üèÜ Top 5 Sem√°foros Eficientes</h6>
                                    </div>
                                    <div id="top-semaforos-eficientes" class="list-group list-group-flush">
                                        <p class="text-muted p-3">Carregando...</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-6">
                                <div class="card bg-darker border-danger">
                                    <div class="card-header bg-dark border-danger">
                                        <h6 class="mb-0 text-danger">‚ö†Ô∏è Top 5 Sem√°foros Ineficientes</h6>
                                    </div>
                                    <div id="top-semaforos-ineficientes" class="list-group list-group-flush">
                                        <p class="text-muted p-3">Carregando...</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-6">
                                <div class="card bg-darker border-success">
                                    <div class="card-header bg-dark border-success">
                                        <h6 class="mb-0 text-success">üèÜ Top 5 Postes Eficientes</h6>
                                    </div>
                                    <div id="top-postes-eficientes" class="list-group list-group-flush">
                                        <p class="text-muted p-3">Carregando...</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-6">
                                <div class="card bg-darker border-danger">
                                    <div class="card-header bg-dark border-danger">
                                        <h6 class="mb-0 text-danger">‚ö†Ô∏è Top 5 Postes Ineficientes</h6>
                                    </div>
                                    <div id="top-postes-ineficientes" class="list-group list-group-flush">
                                        <p class="text-muted p-3">Carregando...</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Sem√°foros Tab -->
                <div id="semaforos-tab" class="tab-content" style="display: none;">
                    <div class="card bg-darker border-info mb-4">
                        <div class="card-body">
                            <h5 class="card-title text-info">Gerenciar Sem√°foros</h5>
                            <div class="row g-2">
                                <div class="col-md-5">
                                    <input type="text" id="semaforoLocalizacao" class="form-control form-control-sm bg-dark text-light border-secondary" placeholder="Localiza√ß√£o (ex: Av. Principal)">
                                </div>
                                <div class="col-md-4">
                                    <input type="number" id="semaforoTempo" class="form-control form-control-sm bg-dark text-light border-secondary" placeholder="Tempo de ciclo (segundos)">
                                </div>
                                <div class="col-md-3">
                                    <button onclick="adicionarSemaforo()" class="btn btn-info btn-sm w-100">‚ûï Adicionar</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card bg-darker border-info">
                        <div class="card-header bg-dark border-info">
                            <h6 class="mb-0 text-info">Sem√°foros Cadastrados</h6>
                        </div>
                        <div id="semaforos-list" class="list-group list-group-flush">
                            <p class="text-muted p-3">Selecione uma regi√£o primeiro</p>
                        </div>
                    </div>
                </div>
                
                <!-- Postes Tab -->
                <div id="postes-tab" class="tab-content" style="display: none;">
                    <div class="card bg-darker border-info mb-4">
                        <div class="card-body">
                            <h5 class="card-title text-info">Gerenciar Postes</h5>
                            <div class="row g-2 align-items-end">
                                <div class="col-md-6">
                                    <input type="text" id="posteLocalizacao" class="form-control form-control-sm bg-dark text-light border-secondary" placeholder="Localiza√ß√£o (ex: Rua A, n¬∫ 100)">
                                </div>
                                <div class="col-md-3">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="posteAutomatico">
                                        <label class="form-check-label" for="posteAutomatico">
                                            Modo Autom√°tico
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <button onclick="adicionarPoste()" class="btn btn-info btn-sm w-100">‚ûï Adicionar</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card bg-darker border-info">
                        <div class="card-header bg-dark border-info">
                            <h6 class="mb-0 text-info">Postes de Ilumina√ß√£o</h6>
                        </div>
                        <div id="postes-list" class="list-group list-group-flush">
                            <p class="text-muted p-3">Selecione uma regi√£o primeiro</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal para adicionar regi√£o -->
    <div class="modal fade" id="regiao-modal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content bg-darker border-info">
                <div class="modal-header border-info">
                    <h5 class="modal-title text-info">Criar Nova Regi√£o</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <input type="text" id="regiao-nome" class="form-control form-control-sm bg-dark text-light border-secondary mb-2" placeholder="Nome da Regi√£o">
                    <input type="text" id="regiao-descricao" class="form-control form-control-sm bg-dark text-light border-secondary" placeholder="Descri√ß√£o (opcional)">
                </div>
                <div class="modal-footer border-info">
                    <button type="button" class="btn btn-secondary btn-sm" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-info btn-sm" onclick="criarRegiao()">Criar</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal para detalhes -->
    <div class="modal fade" id="detail-modal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content bg-darker border-info">
                <div class="modal-header border-info">
                    <h5 class="modal-title text-info">Detalhes</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div id="detail-content"></div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../static/script_simple_new.js?v=8"></script>
</body>
</html>
